<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <link rel="stylesheet" href="style.css">
    <meta charset="utf-8">
    <title>WayOfTheWind</title>
  </head>
  <body>
    <script src="https://code.jquery.com/jquery-3.7.0.js" integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>
    <script src="components/selector.js" type="text/javascript"></script>
    <script src="data/games.json"></script>

    <div class="wrapper">

      <div id="platform" class="platform-selector selector flex" onclick="
        platform = $(`input[name='platform'][type='radio']:checked`).parent();
        val = platform.index();

        $(this).css('--pos',
          parseInt($(this).css('padding-left')) + ($(platform).width() + parseInt($(this).css('gap'))) * val + 'px'
        );

        $('#games>div').css('display','none').attr('disabled','true');

        $('#games>#' + platform.attr('id')).css('display','').removeAttr('disabled');


        $('#preview > .tabs > button').remove();
        for (let emulator of emulators[platform.attr('id')]){
          let path = `assets/emulators/${emulator}.png`;
          $('#preview > .tabs').append(`
            <div id='${emulator}'>
              <input type='radio' name='emulators' />
              <div class='icon' style='background-image:url(&quot;${path}&quot;)'></div>
            </div>
          `)
          // <span>${emulator[0].toUpperCase()+emulator.slice(1)}</span>
        }

      "></div>


      <div class="gimmeaname">

        <div id="games" onmouseover="

          $(this).find('> div:not(:disabled) > div:is(:hover)').each(function(){
            let path = `assets/backdrops/${$(this).attr('id')}.png`;
            let img = new Image();
            img.src = path;

            if (img.height == 0){
              $('body').css('--backdrop-opacity',`0`);
              return;
            };

            $('body').css('--backdrop-opacity',`1`);
            $('body').css('--backdrop', `url('${path}')`);
          });
        "
        onclick="
          $(this).find('> div:not(:disabled) > div:has(input:checked)').each(function(){
            $('#preview').attr('data-game', $(this).attr('id'));

            $('#preview > .info > .chips > span').remove();
            try{
              let game = games[$(`input[name='platform']:checked`).parent().attr('id')][$(this).attr('id')];

              for (let genre of game.genres){
                $('#preview > .info > .chips').append(`
                  <span>${genre}</span>
                `);
              }
            }
            catch{
              return;
            }

            let path = `assets/titles/${$(this).attr('id')}.png`;
            $('#preview > .info > .icon').css('background-image', `url('${path}')`);
          });
        "

        onmouseout="
          let path = `assets/backdrops/${$('#preview').attr('data-game')}.png`;

          let img = new Image();
          img.src = path;

          if (img.height == 0){
            $('body').css('--backdrop-opacity',`0`);
            return;
          };

          $('body').css('--backdrop-opacity',`1`);
          $('body').css('--backdrop', `url('${path}')`);
        "></div>


        <div id="preview" data-game="">

          <div class="info">
            <h2 class="icon"></h2>
            <div class="chips">
              <!-- <div>Release Date</div>
              <div>Genres</div>
              <div>...</div> -->
            </div>
          </div>

          <!-- <div class="spacer"></div> -->

          <div class="tabs">
            <!-- <button type="button" name="button"></button> -->
            <!-- <button type="button" name="button"></button> -->
          </div>

        </div>

      </div>


    </div>


    <nav style="transform: scaleY(-1);
                background-size: cover;
                background-image: url('https://capsule-render.vercel.app/api?type=waving&color=6c7086&height=120&section=header');
                position: absolute;
                width: 100%;
                height: 140px;
                background-position: bottom;
                bottom: 0;
               ">
    </nav>

    <script src="gen.js" type="text/javascript"></script>
    <script src="script.js" type="text/javascript"></script>

  </body>
</html>
